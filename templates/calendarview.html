{% extends "base-static.html" %}
{% load static %}

{% block css %}
  <link href="{% static 'plugins/fullcalendar/fullcalendar.min.css' %}" rel="stylesheet"/>
  <link rel="stylesheet" href="{% static 'dist/css/myself.css' %}">
  {% endblock %}

{% block content %}

 <!-- first content: dashboard -->
 <!-- <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-4 pb-2 mb-3 border-bottom">
  <h1 class="h2">Dashboard</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <div class="btn-group me-2">
      <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
      <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
    </div>
    <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
      <span data-feather="calendar"></span>
      This week
    </button>
  </div>
</div> -->

    <section class="content-header margin-bottom">
      <div class="fs-4 fw-semibold py-4">Calendar</div>
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="box box-primary">
            <div class="box-body no-padding">
                <!-- THE CALENDAR -->
                <div id="calendar">
                </div>
            </div>
            <!-- /.box-body -->
        </div>
    </section>

    <!-- /.content -->


{% endblock %}

{% block javascripts %}
<!-- <script src="{% static 'js/dashboard.js' %}"></script> -->
<script src="{% static 'plugins/daterangepicker/moment.min.js' %}"></script>
<script src="{% static 'plugins/fullcalendar/fullcalendar.min.js' %}"></script>
<script src="{% static 'js/plugins/layer/layer.js' %}"></script>
<script src="{% static 'plugins/select2/select2.full.min.js' %}"></script>
<script src="{% static 'js/mycardview.js' %}"></script>

<script type="text/javascript">
  function doCreate() {
    temp_str = '{{ today|date:"Y-m-d H:i" }}';
    console.log(temp_str);
    window.location="/calendar/create?calDate=" + temp_str;
    // window.location="/calendar/create?calDate=" + date.format("YYYY-MM-DD H:mm");  
  }     
  $(function () {
          //初始化FullCalendar
          $('#calendar').fullCalendar({
            buttonText: {
                    today: 'Today',
                    month: 'Month',
                    week: 'Week',
                    day: 'Day',
                },
                allDayText: "All Day",
                timeFormat: 'HH:mm',
                views: {
                    month: {titleFormat: 'YYYY年MMMM月'},
                    week: {titleFormat: 'YYYY年MMMM月'},
                    day: {titleFormat: 'YYYY年MMMM月D日'},
                },
                monthNames: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
                monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
                dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                dayNamesShort: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                //defaultView: 'agendaWeek',
                // 新增内容：自定义按钮
                customButtons: {
                    reportAddButton: {
                        text: 'Add',
                        click: doCreate,
                    },

                },
                contentHeight: 650,
                header: {
                    //日历头部左边：初始化切换按钮
                    left: 'prev,next today reportAddButton',
                    //日历头部中间：显示当前日期信息
                    center: 'title',
                    //日历头部右边：初始化视图
                    right: 'month,agendaWeek,agendaDay'
                },
                //设置是否显示周六和周日，设为false则不显示
                weekends: true,

                dayClick: function (date, view) {
                    /* layer.open({
                        type: 2,
                        title: '新建日報',
                        shadeClose: false,
                        maxmin: true,
                        area: ['800px', '500px'],
                        content: "/myreport/create?calDate=" + date.format("YYYY-MM-DD H:mm"),
                    }); */
                    window.location="/calendar/create?calDate=" + date.format("YYYY-MM-DD H:mm");
                },
                eventClick: function (calEvent, jsEvent, view) {
                    /* layer.open({
                        type: 2,
                        title: '日報詳情',
                        shadeClose: false,
                        maxmin: true,
                        area: ['800px', '460px'],
                        content: "/myreport/detail?id=" + calEvent.id,

                    }); */
                    var temp_content = loadEmptyEventCard();
                    $('#side-live-view').html(temp_content);
                    $('.event-name').append(calEvent.content);
                    $('.event-category').append(calEvent.category);
                    $('.event-start').append(calEvent.start_time);
                    $('.event-end').append(calEvent.end_time);
                },
                events: [
                        {
                            id: 1,
                            title: 'All day event',
                            start: '2022-02-28',
                            end: '2022-02-28',
                            backgroundcolor: '#dd4b39',
                        },
                    {% for my_report in my_report_all %}
                        {
                            id: '{{ my_report.event_id }}',
                            title: '{{ my_report.content }}',
                            {% if my_report.start_time == my_report.end_time %}
                            // an All Day Event, no need to show timestamp
                            start: '{{ my_report.start_time | date:"Y-m-d"}}',
                            end: '{{ my_report.end_time | date:"Y-m-d"}}',
                            {% else %}
                            start: '{{ my_report.start_time | date:"Y-m-d H:i"}}',
                            end: '{{ my_report.end_time | date:"Y-m-d H:i"}}',
                            {% endif %}
                            {% if my_report.category == 0  %}
                                backgroundColor: '#0073b7',
                            {% elif my_report.category == 1 %}
                                backgroundColor: '#dd4b39',
                            {% else %}
                                backgroundColor: '#00a65a',
                            {% endif %}

                        },
                    {% endfor %}

                ],

            });

      });

/*     $(function () {
        $('#side-live-view').append("Hello Django")

    }); */
</script>




  
{% endblock %}
  

